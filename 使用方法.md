# CSV→Googleカレンダー→Slack自動投稿システム

## 📋 概要

CSVファイルからGoogleカレンダーに予定を自動登録し、毎朝指定した時間にSlackにその日の予定を自動投稿するシステムです。

## 🚀 初期設定

### 1. 必要なファイルの確認

以下のファイルが揃っていることを確認してください：
- `rapid-being-472521-a0-d01f438f34a9.json` (Googleサービスアカウントファイル)
- `schedule test - シート2.csv` (予定データのCSVファイル)

### 2. Slack Webhook URLの設定

1. **Slack API ページ**: https://api.slack.com/apps
2. **作成したアプリを選択**
3. **「Incoming Webhooks」→「Add New Webhook to Workspace」**
4. **実際に使いたいチャンネルを選択**
5. **Webhook URLをコピー**

### 3. 設定ファイルの変更

```bash
python setup_config.py
```

または、`config.py`を直接編集：

```python
# Slack設定
SLACK_WEBHOOK_URL = 'https://hooks.slack.com/services/YOUR_WEBHOOK_URL'
SLACK_CHANNEL = '#your-channel'

# CSV設定
CSV_FILE = 'your_schedule.csv'

# 通知時間
NOTIFICATION_TIME = "10:00"
```

## 📖 使用方法

### メインシステムの実行

```bash
python run_system.py
```

### メニュー選択

1. **CSVファイルのインポート**: CSVファイルからGoogleカレンダーに予定を登録
2. **Slack通知のテスト**: 今日の予定をSlackに送信してテスト
3. **自動スケジューラー開始**: 毎朝指定時間に自動投稿を開始
4. **システム情報表示**: 現在の設定を確認

## 📝 CSVファイルの形式

```csv
名前,日付,開始時間,終了時間,タスク内容
山田太郎,2025-09-20,09:00,12:00,会議
佐藤花子,2025-09-20,14:00,16:00,資料作成
```

### 必須列
- `名前`: 担当者名
- `日付`: 予定日（YYYY-MM-DD形式）
- `開始時間`: 開始時刻（HH:MM形式）
- `終了時間`: 終了時刻（HH:MM形式）
- `タスク内容`: 予定の内容

## 🔧 個別機能の使用

### CSVファイルのインポートのみ

```bash
python csv_to_calendar.py
```

### Slack通知のテストのみ

```bash
python slack_notifier.py
```

### 自動スケジューラーの開始

```bash
python auto_scheduler.py
```

## 📱 Slack表示例

```
🌅 おはようございます！
📅 2025年09月20日の予定 📅

🕐 *9:00-12:00*: 山田太郎: 会議
🕐 *14:00-16:00*: 佐藤花子: 資料作成

💪 今日も一日頑張りましょう！
```

## ⚠️ 注意事項

1. **Googleカレンダーの共有**: サービスアカウントのメールアドレスにカレンダーを共有する必要があります
2. **CSVファイルの文字エンコーディング**: UTF-8で保存してください
3. **時間形式**: 24時間表記で入力してください（例：09:00, 14:30）
4. **日付形式**: YYYY-MM-DD形式で入力してください

## 🆘 トラブルシューティング

### よくあるエラー

1. **「サービスアカウントファイルが見つかりません」**
   - JSONファイルが正しい場所にあるか確認

2. **「カレンダーが見つかりません」**
   - カレンダーがサービスアカウントと共有されているか確認

3. **「Slack送信に失敗しました: 404」**
   - Webhook URLが正しいか確認

4. **時間が正しく表示されない**
   - CSVファイルの時間形式が正しいか確認（HH:MM形式）

## 📞 サポート

問題が解決しない場合は、以下を確認してください：
- `config.py`の設定
- CSVファイルの形式
- Googleカレンダーの共有設定
- Slack Webhook URLの設定
