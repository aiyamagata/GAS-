# CSV→Googleカレンダー→Slack自動投稿システム 完全ガイド

## 📋 概要

このシステムを使うと、以下のことが自動でできます：

1. **CSVファイル**から予定データを読み込む
2. **Googleカレンダー**に予定を自動登録する
3. **Slack**に毎朝10時にその日の予定を自動投稿する

## 🎯 完成イメージ

```
CSVファイル → Googleカレンダー → 毎朝10時にSlackに投稿
```

### Slack投稿例
```
🌅 おはようございます！
📅 2024年09月25日の予定 📅

🕐 09:00-10:00: 田中太郎: 朝のミーティング 📍会議室A
🕐 10:30-12:00: 佐藤花子: 顧客との打ち合わせ 📍本社ビル
🕐 14:00-16:00: 鈴木一郎: 開発作業 📍デスク
🕐 16:30-17:30: 高橋美咲: 報告書作成 📍デスク

💪 今日も一日頑張りましょう！
```

## 🛠️ 準備作業

### 1. 必要なライブラリのインストール

```bash
# ターミナルで以下のコマンドを実行
cd "/Users/yamagataai/Desktop/Cursor API/GoogleCalendarAPI"
pip install -r requirements.txt
```

### 2. Googleカレンダーの設定

#### 2-1. Google Cloud Consoleでの設定
1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. プロジェクトを作成または選択
3. 「APIとサービス」→「ライブラリ」から「Google Calendar API」を有効化
4. 「APIとサービス」→「認証情報」からサービスアカウントを作成
5. JSONキーファイルをダウンロード

#### 2-2. カレンダーの共有設定
1. [Googleカレンダー](https://calendar.google.com/)にアクセス
2. 共有したいカレンダーの「⋮」→「設定と共有」
3. 「特定のユーザーと共有」で以下を追加：
   - メールアドレス: `shiromaru@rapid-being-472521-a0.iam.gserviceaccount.com`
   - 権限: 「変更イベントを管理」

### 3. Slackの設定

#### 3-1. Slack Appの作成
1. [Slack API](https://api.slack.com/apps)にアクセス
2. 「Create New App」→「From scratch」
3. App名を入力（例: 「Calendar Bot」）
4. Slackワークスペースを選択

#### 3-2. Webhookの設定
1. 作成したAppの「Incoming Webhooks」を有効化
2. 「Add New Webhook to Workspace」
3. 投稿先チャンネルを選択
4. Webhook URLをコピー（後で使用）

## 📁 ファイル構成

```
GoogleCalendarAPI/
├── main_system.py              # メインシステム（これを使います）
├── csv_to_calendar.py          # CSV→カレンダー変換
├── slack_notifier.py           # Slack通知機能
├── auto_scheduler.py           # 自動スケジューラー
├── sample_schedule.csv         # サンプルCSVファイル
├── google_calendar_client.py   # GoogleカレンダーAPI
├── rapid-being-472521-a0-d01f438f34a9.json  # サービスアカウントファイル
└── requirements.txt            # 必要なライブラリ
```

## 🚀 使用方法

### ステップ1: システムを起動

```bash
cd "/Users/yamagataai/Desktop/Cursor API/GoogleCalendarAPI"
python main_system.py
```

### ステップ2: メニューから操作

システムが起動すると、以下のメニューが表示されます：

```
📋 メインメニュー
==============================
1. Slackの設定
2. CSVファイルのインポートテスト
3. Slack通知のテスト
4. 完全なワークフロー実行
5. 自動スケジューラー開始
6. システム情報表示
7. 終了
```

### ステップ3: 順番に設定

#### 3-1. Slackの設定（メニュー1）
1. メニューで「1」を選択
2. SlackのWebhook URLを入力
3. 投稿先チャンネルを設定

#### 3-2. CSVインポートテスト（メニュー2）
1. メニューで「2」を選択
2. サンプルCSVファイルから予定を作成
3. 成功すればGoogleカレンダーに予定が追加される

#### 3-3. Slack通知テスト（メニュー3）
1. メニューで「3」を選択
2. 今日の予定をSlackに送信
3. 指定したチャンネルにメッセージが投稿される

#### 3-4. 自動スケジューラー開始（メニュー5）
1. メニューで「5」を選択
2. 毎朝10時の自動投稿を開始
3. システムは継続して動作

## 📝 CSVファイルの形式

### サンプルファイル（sample_schedule.csv）

```csv
名前,日付,開始時刻,終了時刻,予定内容,場所,メモ
田中太郎,2024-09-25,09:00,10:00,朝のミーティング,会議室A,プロジェクト進捗確認
佐藤花子,2024-09-25,10:30,12:00,顧客との打ち合わせ,本社ビル,新規契約について
鈴木一郎,2024-09-25,14:00,16:00,開発作業,デスク,新機能の実装
高橋美咲,2024-09-25,16:30,17:30,報告書作成,デスク,週次レポート
```

### CSVファイルの作成方法

1. **Excel**または**Googleスプレッドシート**で作成
2. 以下の列を含める：
   - **名前**: 担当者の名前
   - **日付**: YYYY-MM-DD形式（例: 2024-09-25）
   - **開始時刻**: HH:MM形式（例: 09:00）
   - **終了時刻**: HH:MM形式（例: 10:00）
   - **予定内容**: 予定のタイトル
   - **場所**: 予定の場所
   - **メモ**: 追加情報

3. **CSV形式で保存**（UTF-8エンコーディング）

## 🔧 トラブルシューティング

### よくあるエラーと解決方法

#### エラー1: サービスアカウントファイルが見つからない
```
FileNotFoundError: サービスアカウントファイルが見つかりません
```

**解決方法:**
- 正しいディレクトリから実行しているか確認
- サービスアカウントファイルが存在するか確認

#### エラー2: カレンダーが見つからない
```
❌ カレンダーが見つかりません
```

**解決方法:**
- Googleカレンダーでサービスアカウントと共有設定が完了しているか確認
- 数分待ってから再実行

#### エラー3: Slack送信に失敗
```
❌ Slack送信に失敗しました
```

**解決方法:**
- Webhook URLが正しいか確認
- Slack Appの設定が完了しているか確認
- チャンネル名が正しいか確認（例: #general）

## 📱 日常的な使い方

### 毎日の作業フロー

1. **CSVファイルを更新**
   - Excelやスプレッドシートで予定を追加・変更
   - CSVファイルとして保存

2. **システムを起動**
   ```bash
   python main_system.py
   ```

3. **CSVをインポート**
   - メニュー2でCSVインポートテストを実行

4. **自動スケジューラーを開始**
   - メニュー5で毎朝10時の自動投稿を開始

### 自動化の設定

システムを常時動作させるには：

1. **ターミナルを開いたままにする**
2. **メニュー5で自動スケジューラーを開始**
3. **毎朝10時に自動でSlackに投稿される**

## 🎉 完成！

これで、CSVファイルからGoogleカレンダーに予定を自動登録し、毎朝10時にSlackに投稿するシステムが完成です！

### システムの特徴

- ✅ **初心者でも簡単**: メニュー形式で操作
- ✅ **自動化**: 毎朝10時に自動投稿
- ✅ **柔軟性**: CSVファイルで簡単に予定管理
- ✅ **視覚的**: Slackで美しい予定表を表示

### 次のステップ

- CSVファイルの形式をカスタマイズ
- 投稿時間の変更（10:00以外）
- 複数のチャンネルへの投稿
- 予定の種類別の色分け

何か質問があれば、お気軽にお聞きください！
